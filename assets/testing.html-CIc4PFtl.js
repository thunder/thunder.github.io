import{_ as s,c as a,a as t,o as n}from"./app-Dzh1Bu_Q.js";const r={};function i(o,e){return n(),a("div",null,e[0]||(e[0]=[t(`<h1 id="testing" tabindex="-1"><a class="header-anchor" href="#testing"><span>Testing</span></a></h1><p>Thunder comes with an extensive set of tests and base classes, and you can benefit from that.</p><h2 id="write-tests" tabindex="-1"><a class="header-anchor" href="#write-tests"><span>Write tests</span></a></h2><p>Thunder provides two base classes, <code>ThunderTestBase.php</code> for functional browser tests and <code>ThunderJavascriptTestBase.php</code> for javascript tests. If you want to write tests for your project, you should use these classes.</p><p>There are also some traits, that provides useful functionalities:</p><ul><li><code>ThunderTestTrait.php</code></li><li><code>ThunderJavascriptTrait.php</code></li><li><code>ThunderArticleTestTrait.php</code></li><li><code>ThunderCkEditorTestTrait.php</code></li><li><code>ThunderMediaLibraryTestTrait.php</code></li><li><code>ThunderFormFieldTestTrait.php</code></li><li><code>ThunderMediaTestTrait.php</code></li><li><code>ThunderMetaTagTrait.php</code></li><li><code>ThunderParagraphsTestTrait.php</code></li><li><code>ThunderGqlsTestTrait.php</code></li></ul><h3 id="use-thunder-test-mock-request-for-external-requests" tabindex="-1"><a class="header-anchor" href="#use-thunder-test-mock-request-for-external-requests"><span>Use thunder_test_mock_request for external requests</span></a></h3><p>With the help of the <code>thunder_test_mock_request</code> test module, it&#39;s easy to mock external requests and make your tests more stable and reliable.</p><p>You just have to define the response for a request URL.</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php"><pre><code class="language-php"><span class="line"><span class="token class-name class-name-fully-qualified static-context">Drupal<span class="token punctuation">\\</span>thunder_test_mock_request<span class="token punctuation">\\</span>MockHttpClientMiddleware</span><span class="token operator">::</span><span class="token function">addUrlResponse</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;https://oembed.com/providers.json&#39;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&#39;/path/to/myresponse.json&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;Content-Type&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;application/json&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>Note:</strong> If <code>thunder_test_mock_request</code> is enabled, all external requests have to be mocked.</p><h2 id="run-tests" tabindex="-1"><a class="header-anchor" href="#run-tests"><span>Run tests</span></a></h2><p>Running tests for a project isn&#39;t that easy. Since all your tests have the <code>$profile</code> variable set to &#39;thunder&#39;, the test runs against a plain Thunder installation. So these test sites, wouldn&#39;t contain any configuration changes from your project.</p><p>To prevent that, <code>ThunderTestTrait.php</code> can receive a database dump that is installed before the test runs.</p><h3 id="create-database-dump" tabindex="-1"><a class="header-anchor" href="#create-database-dump"><span>Create database dump</span></a></h3><p>Before you create the database dump, you should install your site from configuration to have an empty site without any content.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">drush si --existing-config</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>After that create the database dump:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">cd</span> docroot</span>
<span class="line">php ./core/scripts/db-tools.php dump-database-d8-mysql <span class="token operator">|</span> <span class="token function">gzip</span> <span class="token operator">&gt;</span> thunder.sql.gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="execute-tests" tabindex="-1"><a class="header-anchor" href="#execute-tests"><span>Execute tests</span></a></h3><p>Before you execute your test, you have to set the <code>thunderDumpFile</code> env variable.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">thunderDumpFile</span><span class="token operator">=</span>/path/to/thunder.sql.gz</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Now you can execute your test, as described in the official <a href="https://www.drupal.org/docs/automated-testing/phpunit-in-drupal" target="_blank" rel="noopener noreferrer">Drupal documentation</a></p>`,23)]))}const l=s(r,[["render",i]]),d=JSON.parse('{"path":"/developer-guide/testing.html","title":"Testing","lang":"en-US","frontmatter":{},"git":{"updatedTime":1766052996000,"contributors":[{"name":"Daniel Bosen","username":"","email":"daniel.bosen@burda.com","commits":1}],"changelog":[{"hash":"ff82b5e334b60cf225703a1c19508730634995b5","time":1766052996000,"email":"daniel.bosen@burda.com","author":"Daniel Bosen","message":"#3563825 Release Thunder 8.2.7"}]},"filePathRelative":"developer-guide/testing.md"}');export{l as comp,d as data};
