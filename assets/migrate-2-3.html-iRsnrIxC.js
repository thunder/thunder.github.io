import{_ as t,c as i,b as a,a as r,d as s,e as o,w as l,r as d,o as u}from"./app-Dzh1Bu_Q.js";const p={};function c(m,e){const n=d("RouteLink");return u(),i("div",null,[e[3]||(e[3]=a("h1",{id:"update-thunder-2-thunder-3",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#update-thunder-2-thunder-3"},[a("span",null,"Update Thunder 2 -> Thunder 3")])],-1)),e[4]||(e[4]=a("h2",{id:"prerequisites",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#prerequisites"},[a("span",null,"Prerequisites")])],-1)),a("p",null,[e[1]||(e[1]=s("These are the instructions to manually update your existing Thunder 2 installation to Thunder 3. If you want to do a fresh installation of thunder please visit ")),o(n,{to:"/developer-guide/setup.html#install-thunder"},{default:l(()=>e[0]||(e[0]=[s("install Thunder")])),_:1,__:[0]}),e[2]||(e[2]=s(". The most significant change is the migration to media in core. But we also made some changes to our composer.json."))]),e[5]||(e[5]=r(`<p>You have to make sure, that your Thunder 2 project and all it&#39;s dependecies, are fully updated to the most current versions. Run the following command in your docroot:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">drush ev <span class="token string">&quot;print drupal_get_installed_schema_version(&#39;thunder&#39;) . PHP_EOL;&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This should print the number 8138 or greater. If that is not the case, update your project.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span></span>
<span class="line"><span class="token function">composer</span> update</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>This should update to Thunder 8.2.47 or greater.</p><p>Now run database updates:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token builtin class-name">cd</span> docroot</span>
<span class="line">drush updb</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>You should at least see the thunder 8138 schema update. If not, double check that the correct version of Thunder is installed, and that <code>drush updb</code> did not throw any errors.</p><h2 id="composer-adjustments" tabindex="-1"><a class="header-anchor" href="#composer-adjustments"><span>Composer adjustments</span></a></h2><p>We switched from bower-asset to npm-asset for our frontend-libraries. In order to get the libraries downloaded to the correct location, please replace</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token property">&quot;installer-types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;bower-asset&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>by</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token property">&quot;installer-types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;bower-asset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;npm-asset&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>in the composer.json of your project and add &quot;type:npm-asset&quot; to the &quot;docroot/libraries/{$name}&quot; section in installer-paths.</p><p>We moved the composer package under the thunder namespace, so remove the old package and a the new one.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">composer</span> remove burdamagazinorg/thunder</span>
<span class="line"><span class="token function">composer</span> require <span class="token string">&quot;thunder/thunder-distribution:~3.3&quot;</span> --no-update</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>You have to update composer now.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">composer</span> update</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>We removed some modules from our codebase. In case you are using one of below mentioned modules please require them manually for your project.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">composer</span> require drupal/views_load_more --no-update</span>
<span class="line"><span class="token function">composer</span> require drupal/breakpoint_js_settings --no-update</span>
<span class="line"><span class="token function">composer</span> require valiton/harbourmaster --no-update</span>
<span class="line"><span class="token function">composer</span> require drupal/riddle_marketplace:~3.0 --no-update</span>
<span class="line"><span class="token function">composer</span> require drupal/nexx_integration:~3.0 --no-update</span>
<span class="line"><span class="token function">composer</span> require burdamagazinorg/infinite_module:~1.0 --no-update</span>
<span class="line"><span class="token function">composer</span> require burdamagazinorg/infinite_theme:~1.0 --no-update</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="update-facebook-instant-articles-integration" tabindex="-1"><a class="header-anchor" href="#update-facebook-instant-articles-integration"><span>Update Facebook instant articles integration</span></a></h2><p>In case you are using the fb_instant_articles module, please note that the RSS feed url will change and therefore needs to be updated in the facebook account.</p><p>When updating while fb_instant_articles is enabled, there will be an error message like <code>The &quot;fiafields&quot; plugin does not exist. Valid plugin IDs for Drupal\\views\\Plugin\\ViewsPluginManager are: ...</code> this is due to invalid configuration present in the system before the update and can safely be ignored.</p><h2 id="pre-requirements-for-media-update" tabindex="-1"><a class="header-anchor" href="#pre-requirements-for-media-update"><span>Pre-requirements for media update</span></a></h2><p>First we should make sure that the latest drush version is installed.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">composer</span> require drush/drush:~10.0 --no-update</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>After that the following steps should be done for the update:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">composer</span> require drupal/media_entity:^2.0 drupal/media_entity_image drupal/video_embed_field:^2.2</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>Make sure that you use the &quot;Media in core&quot; branch for all your media_* modules. (For the media modules in Thunder, we take care of that)</li><li>Make sure that all your code that uses media_entity API is modified to use the core media API.</li></ul><p>See here for more information:</p><ul><li><a href="https://www.drupal.org/node/2863992" target="_blank" rel="noopener noreferrer">Moved a refined version of the contributed Media entity module to core as Media module</a></li><li><a href="https://www.drupal.org/docs/8/core/modules/media/faq-transition-from-media-entity-to-media-in-core#upgrade-instructions-from-media-entity-contrib-to-media-in-core" target="_blank" rel="noopener noreferrer">FAQ - Transition from Media Entity to Media in core</a></li></ul><h2 id="execute-media-update" tabindex="-1"><a class="header-anchor" href="#execute-media-update"><span>Execute media update</span></a></h2><p>All you need to do now is:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">drush updb</span>
<span class="line">drush cr</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="cleanup-codebase" tabindex="-1"><a class="header-anchor" href="#cleanup-codebase"><span>Cleanup codebase</span></a></h2><p>Now the update is done and you can remove some modules from your project.</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">composer</span> remove drupal/media_entity drupal/media_entity_image</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,37))])}const b=t(p,[["render",c]]),g=JSON.parse('{"path":"/developer-guide/migration/migrate-2-3.html","title":"Update Thunder 2 -> Thunder 3","lang":"en-US","frontmatter":{},"git":{"updatedTime":1766052996000,"contributors":[{"name":"Daniel Bosen","username":"","email":"daniel.bosen@burda.com","commits":1}],"changelog":[{"hash":"ff82b5e334b60cf225703a1c19508730634995b5","time":1766052996000,"email":"daniel.bosen@burda.com","author":"Daniel Bosen","message":"#3563825 Release Thunder 8.2.7"}]},"filePathRelative":"developer-guide/migration/migrate-2-3.md"}');export{b as comp,g as data};
